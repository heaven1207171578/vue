<!DOCTYPE html>
<html lang="en">
<head>
  <script src="../lib/js/vue.js"></script>
  <link rel="stylesheet" href="../lib/css/bootstrap.css">
  <!--<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">-->
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<div id="app">
  <div class="panel panel-primary">
    <div class="panel-heading">
      <h3 class="panel-title">添加品牌</h3>
    </div>
    <div class="panel-body form-inline">
      <label>Id:
        <input type="text" class="form-control" v-model="id">
      </label>
      <label>Name:
        <input type="text" class="form-control" v-model="name" >
      </label>
      <input type="button" value="添加" class="btn btn-primary" @click="add()">
      <hr>
      <label>搜索名称关键字:
        <input type="text" class="form-control" v-focus v-color="'blue'" v-model="keywords">
      </label>
    </div>
  </div>
  <table class="table table-bordered table-hover table-striped">
    <thead>
      <th>Id</th>
      <th>Name</th>
      <th>Ctime</th>
      <th>Operation</th>
    </thead>

    <tbody>
    <!--之前,v-for的数据都是直接data中的list上拿到的-->
    <!--<tr v-for="item in list" :key="item.id">-->
    <!--现在,我们自定义一个search()方法,同时把 所有的关键字,通过传参的形式,传递给了search()方法-->
    <tr v-for="item in search(keywords)" :key="item.id">
      <td>{{ item.id }}</td>
      <td v-text="item.name"></td>
      <td>{{item.ctime | dataformat('yyyy-MM-dd HH:mm:ss')}}</td>
      <td>
        <a href="" @click.prevent="remove(item.id)">删除</a>
      </td>
    </tr>
    </tbody>
  </table>
</div>
<div id="app2">
  <h3>{{dt | dataformat('yyyy-mm')}}</h3>
</div>
<script>
  //全局过滤器,时间格式化
  //全局过滤器,所有的vm实例都可以共享
  Vue.filter('dataformat',function (ctime,pattern='') {
    var dt=new Date(ctime);
    var year=dt.getFullYear();
    var month=dt.getMonth()+1; //getMonth从0开始;
    var day=dt.getDate();
    var hour=dt.getHours();
    var minte=dt.getMinutes();
    var second=dt.getSeconds();
    // return '${year}-${month}-${day}';
    if (pattern.toLowerCase()=='yyyy-mm-dd'){
      return year+'-'+ month +'-'+day;
    }else {
      return `${year}-${month}-${day} ${hour}:${minte}:${second}`;
      //return year+'-'+ month +'-'+day+'-';
    }
  })


  new Vue({
    el:"#app2",
    data:{
      dt:new Date()
    },
    methods:{},
    //如何自定义一个私有的过滤器
    //有私有过滤器 如果过滤器名称一样,vm优先调用私有 没有再去寻找全局
    //padStart():从字符串开头填充, 参数1:填充位数, 参数2:填充值
    filters:{
      dataformat:function (ctime,pattern) {
        var dt=new Date(ctime);
        var year=dt.getFullYear();
        var month=(dt.getMonth()+1).toString().padStart(2,'0'); //getMonth从0开始;
        var day=dt.getDate().toString().padStart(2,'0');
        var hour=dt.getHours().toString().padStart(2,'0');
        var minte=dt.getMinutes().toString().padStart(2,'0');
        var second=dt.getSeconds().toString().padStart(2,'0');
        // return '${year}-${month}-${day}';
        if (pattern.toLowerCase()=='yyyy-mm-dd'){
          return year+'-'+ month +'-'+day;
        }else {
          return `${year}-${month}-${day} ${hour}:${minte}:${second}`;
        }
      }
    }
  })

  new Vue({
    el: "#app",
    data: {
      list: [
        {id: '1', name: 'cang', ctime: new Date()},
        {id: '2', name: 'tai', ctime: new Date()},
        {id: '3', name: 'yue', ctime: new Date()},
        {id: '4', name: 'chen', ctime: new Date()}
      ],
      id:'',
      name:'',
      keywords:''
    },
    methods: {
      add(){
        var user={id:this.id,name:this.name,ctime:new Date()};
        this.list.push(user)
        // this.name='';
        // this.id='';
        //添加一次之后 id,name的框就变成空
        //同上 联合赋值. 从右向左赋值
         this.id=this.name='';
      },
      remove(id){ //根据id 删除数据
        alert(id);
        this.list.some((item,i)=>{
          if (item.id==id){
            this.list.splice(i,1);//删除的索引,删除几个
            return true; //  在数组的some方法中,如果return true, 就会立即终止循环
          }
        })
        /*this.list.findIndex(item=>{
          if (item.id==id){
            return true;
          }
        })*/
      },
      search(keywords){
        var newList=[];
        /*this.list.forEach(item=>{
          if (item.name.indexOf(keywords)!=-1){
            newList.push(item);
          }
           return newList;
        })
       */
        return this.list.filter(item=>{//过滤
          if (item.name.includes(keywords)){//包含
            return item;
          }
        })
      }
    }
  })
  //---------------------------------------------------------------------------------------------
  /* var vm=new Vue({
  el:"#app",
  data(){
  return {
  list: [
  {id: '1', name: 'cang', ctime: new Date()},
  {id: '2', name: 'tai', ctime: new Date()},
  {id: '3', name: 'yue', ctime: new Date()},
  {id: '4', name: 'chen', ctime: new Date()}
  ]
  }
  }
  })
  */
  /*export default {
  name:'app',
  data(){
  return{
  list:[
  {id:'1',name:'cang',ctime:new Date()},
  {id:'2',name:'tai',ctime:new Date()},
  {id:'3',name:'yue',ctime:new Date()},
  {id:'4',name:'chen',ctime:new Date()}
  ]
  }
  }
  }
  */
</script>
</body>

</html>
